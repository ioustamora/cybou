// File Encryption Window
import { Button, CheckBox, ComboBox, GroupBox, HorizontalBox, LineEdit, ScrollView, VerticalBox } from "std-widgets.slint";

export component FileEncryptionWindow inherits Window {
    title: "Cybou - File Encryption";
    width: 600px;
    height: 500px;

    in-out property <string> input-file: "";
    in-out property <string> output-file: "";
    in-out property <string> status: "Ready";
    property <bool> use-hybrid: true;
    property <bool> use-aes: false;
    property <bool> use-chacha: false;
    property <string> algorithm: "Kyber + AES-GCM (Hybrid)";
    property <bool> compress: true;
    property <bool> overwrite: false;

    callback select-input-file();
    callback select-output-file();
    callback encrypt();
    callback decrypt();
    callback clear();

    VerticalBox {
        // Header
        HorizontalBox {
            Text {
                text: "ðŸ“ File Encryption";
                font-size: 16px;
                font-weight: 600;
            }
            HorizontalBox { width: 1px; } // Spacer
            Button {
                text: "âŒ Close";
                clicked => { /* TODO: Close window */ }
            }
        }

        // Separator
        Rectangle { height: 1px; background: #cccccc; }

        // Algorithm Selection
        GroupBox {
            title: "ðŸ” Encryption Algorithm";

            VerticalBox {
                ComboBox {
                    model: ["Kyber + AES-GCM (Hybrid)", "Kyber + ChaCha20-Poly1305", "AES-GCM Only", "ChaCha20-Poly1305 Only"];
                    current-value: algorithm;
                    selected(value) => {
                        algorithm = value;
                        use-hybrid = algorithm == "Kyber + AES-GCM (Hybrid)" || algorithm == "Kyber + ChaCha20-Poly1305";
                        use-aes = algorithm == "Kyber + AES-GCM (Hybrid)" || algorithm == "AES-GCM Only";
                        use-chacha = algorithm == "Kyber + ChaCha20-Poly1305" || algorithm == "ChaCha20-Poly1305 Only";
                    }
                }
                CheckBox {
                    text: "Compress file before encryption";
                    checked <=> compress;
                }
                CheckBox {
                    text: "Overwrite original file";
                    checked <=> overwrite;
                }
            }
        }

        // Key/Password Input
        GroupBox {
            title: "ðŸ”‘ Key / Password";

            VerticalBox {
                Text { text: "Keys are derived from mnemonic. Ensure mnemonic is validated."; }
            }
        }

        // File Selection
        GroupBox {
            title: "ðŸ“ Files";

            VerticalBox {
                HorizontalBox {
                    Text { text: "Input File:"; width: 80px; }
                    Text { 
                        text: input-file; 
                    }
                    Button {
                        text: "ðŸ“ Browse";
                        clicked => { select-input-file(); }
                    }
                }
                HorizontalBox {
                    Text { text: "Output File:"; width: 80px; }
                    Text { text: output-file; }
                    Button {
                        text: "ðŸ“ Browse";
                        clicked => { select-output-file(); }
                    }
                }
            }
        }

        // Action Buttons
        HorizontalBox {
            Button {
                text: "ðŸ” Encrypt";
                clicked => { encrypt(); }
            }
            Button {
                text: "ðŸ”“ Decrypt";
                clicked => { decrypt(); }
            }
            Button {
                text: "ðŸ—‘ï¸ Clear";
                clicked => { clear(); }
            }
        }

        // Progress/Status
        GroupBox {
            title: "ðŸ“Š Progress";

            VerticalBox {
                Text { text: "Status:"; }
                Text {
                    text: status;
                    color: status == "Ready" ? #666666 : #00aa00;
                }
            }
        }
    }
}