// Folder Encryption Window
import { Button, CheckBox, ComboBox, GroupBox, HorizontalBox, LineEdit, ScrollView, VerticalBox } from "std-widgets.slint";

export component FolderEncryptionWindow inherits Window {
    title: "Cybou - Folder Encryption";
    width: 600px;
    height: 500px;

    in-out property <string> input-folder: "";
    in-out property <string> output-folder: "";
    in-out property <string> status: "Ready";
    in-out property <string> progress: "";
    in-out property <bool> use-hybrid: true;
    in-out property <bool> use-aes: false;
    in-out property <bool> use-chacha: false;
    in-out property <string> algorithm: "Kyber + AES-GCM (Hybrid)";
    in-out property <bool> compress: true;
    in-out property <bool> recursive: true;
    in-out property <bool> preserve-structure: true;

    callback select-input-folder();
    callback select-output-folder();
    callback encrypt();
    callback decrypt();
    callback clear();

    VerticalBox {
        // Header
        HorizontalBox {
            Text {
                text: "ðŸ“‚ Folder Encryption";
                font-size: 16px;
                font-weight: 600;
            }
            HorizontalBox { width: 1px; } // Spacer
            Button {
                text: "âŒ Close";
                clicked => { /* TODO: Close window */ }
            }
        }

        // Separator
        Rectangle { height: 1px; background: #cccccc; }

        // Algorithm Selection
        GroupBox {
            title: "ðŸ” Encryption Algorithm";

            VerticalBox {
                ComboBox {
                    model: ["Kyber + AES-GCM (Hybrid)", "Kyber + ChaCha20-Poly1305", "AES-GCM Only", "ChaCha20-Poly1305 Only"];
                    current-value: algorithm;
                    selected(value) => {
                        algorithm = value;
                        use-hybrid = algorithm == "Kyber + AES-GCM (Hybrid)" || algorithm == "Kyber + ChaCha20-Poly1305";
                        use-aes = algorithm == "Kyber + AES-GCM (Hybrid)" || algorithm == "AES-GCM Only";
                        use-chacha = algorithm == "Kyber + ChaCha20-Poly1305" || algorithm == "ChaCha20-Poly1305 Only";
                    }
                }
                CheckBox {
                    text: "Compress folder before encryption";
                    checked <=> compress;
                }
                CheckBox {
                    text: "Process subfolders recursively";
                    checked <=> recursive;
                }
                CheckBox {
                    text: "Preserve folder structure";
                    checked <=> preserve-structure;
                }
            }
        }

        // Key/Password Input
        GroupBox {
            title: "ðŸ”‘ Key / Password";

            VerticalBox {
                Text { text: "Keys are derived from mnemonic. Ensure mnemonic is validated."; }
            }
        }

        // Folder Selection
        GroupBox {
            title: "ðŸ“ Folders";

            VerticalBox {
                HorizontalBox {
                    Text { text: "Input Folder:"; width: 100px; }
                    LineEdit {
                        placeholder-text: "Select input folder...";
                        text: input-folder;
                        read-only: true;
                    }
                    Button {
                        text: "ðŸ“ Browse";
                        clicked => { select-input-folder(); }
                    }
                }
                HorizontalBox {
                    Text { text: "Output Folder:"; width: 100px; }
                    LineEdit {
                        placeholder-text: "Select output folder...";
                        text: output-folder;
                        read-only: true;
                    }
                    Button {
                        text: "ðŸ“ Browse";
                        clicked => { select-output-folder(); }
                    }
                }
            }
        }

        // Action Buttons
        HorizontalBox {
            Button {
                text: "ðŸ” Encrypt Folder";
                clicked => { encrypt(); }
            }
            Button {
                text: "ðŸ”“ Decrypt Folder";
                clicked => { decrypt(); }
            }
            Button {
                text: "ðŸ—‘ï¸ Clear";
                clicked => { clear(); }
            }
        }

        // Progress/Status
        GroupBox {
            title: "ðŸ“Š Progress";

            VerticalBox {
                Text { text: "Status:"; }
                Text {
                    text: status;
                    color: status == "Ready" ? #666666 : #00aa00;
                }
                Text { text: "Progress:"; }
                Text {
                    text: progress;
                    color: #666666;
                }
            }
        }
    }
}