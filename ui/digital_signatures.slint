// Digital Signatures Window
import { Button, ComboBox, GroupBox, HorizontalBox, LineEdit, ScrollView, TextEdit, VerticalBox } from "std-widgets.slint";

export component DigitalSignaturesWindow inherits Window {
    title: "Cybou - Digital Signatures";
    width: 700px;
    height: 600px;

    in-out property <string> message: "";
    in-out property <string> signature: "";
    in-out property <string> status: "Ready";
    in-out property <string> file-path: "";
    in-out property <bool> is-text-mode: true;
    in-out property <bool> is-sign-mode: true;

    callback sign-text();
    callback sign-file();
    callback verify-text();
    callback verify-file();
    callback select-file();
    callback clear();
    callback copy-signature();

    VerticalBox {
        // Header
        HorizontalBox {
            Text {
                text: "‚úçÔ∏è Digital Signatures";
                font-size: 16px;
                font-weight: 600;
            }
            HorizontalBox { width: 1px; } // Spacer
            Button {
                text: "‚ùå Close";
                clicked => { /* TODO: Close window */ }
            }
        }

        // Separator
        Rectangle { height: 1px; background: #cccccc; }

        // Mode Selection
        GroupBox {
            title: "üîß Operation Mode";

            HorizontalBox {
                Button {
                    text: "üìù Text";
                    checked: is-text-mode;
                    clicked => { is-text-mode = true; }
                }
                Button {
                    text: "üìÅ File";
                    checked: !is-text-mode;
                    clicked => { is-text-mode = false; }
                }
                Rectangle { width: 20px; }
                Button {
                    text: "‚úçÔ∏è Sign";
                    checked: is-sign-mode;
                    clicked => { is-sign-mode = true; }
                }
                Button {
                    text: "‚úÖ Verify";
                    checked: !is-sign-mode;
                    clicked => { is-sign-mode = false; }
                }
            }
        }

        // Key Info
        GroupBox {
            title: "üîë Keys";

            VerticalBox {
                Text { text: "Keys are derived from your validated mnemonic phrase."; }
                Text { text: "Ensure mnemonic is loaded before signing or verifying."; }
            }
        }

        // Input Section
        GroupBox {
            title: is-text-mode ? "üìù Text Input" : "üìÅ File Input";

            VerticalBox {
                if (is-text-mode): TextEdit {
                    text <=> message;
                    placeholder-text: is-sign-mode ? "Enter text to sign..." : "Enter text to verify...";
                    wrap: word-wrap;
                    height: 100px;
                }
                if (!is-text-mode): HorizontalBox {
                    LineEdit {
                        text <=> file-path;
                        placeholder-text: "Select file...";
                        read-only: true;
                    }
                    Button {
                        text: "üìÅ Browse";
                        clicked => { select-file(); }
                    }
                }
            }
        }

        // Signature Section
        GroupBox {
            title: "‚úçÔ∏è Signature";

            VerticalBox {
                TextEdit {
                    text <=> signature;
                    placeholder-text: is-sign-mode ? "Signature will appear here..." : "Paste signature to verify...";
                    wrap: word-wrap;
                    read-only: is-sign-mode;
                    height: 80px;
                }
                HorizontalBox {
                    Button {
                        text: "üìã Copy";
                        clicked => { copy-signature(); }
                    }
                }
            }
        }

        // Action Buttons
        HorizontalBox {
            Button {
                text: is-sign-mode ? (is-text-mode ? "‚úçÔ∏è Sign Text" : "‚úçÔ∏è Sign File") : (is-text-mode ? "‚úÖ Verify Text" : "‚úÖ Verify File");
                clicked => {
                    if (is-sign-mode) {
                        if (is-text-mode) { sign-text(); } else { sign-file(); }
                    } else {
                        if (is-text-mode) { verify-text(); } else { verify-file(); }
                    }
                }
            }
            Button {
                text: "üóëÔ∏è Clear";
                clicked => { clear(); }
            }
        }

        // Status
        HorizontalBox {
            Text { text: "üìä Status:"; }
            Text {
                text: status;
                color: status == "Ready" ? #666666 : #00aa00;
            }
        }
    }
}