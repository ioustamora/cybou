// Text Encryption Window
import { Button, CheckBox, ComboBox, GroupBox, HorizontalBox, LineEdit, ScrollView, TextEdit, VerticalBox } from "std-widgets.slint";

export component TextEncryptionWindow inherits Window {
    title: "Cybou - Text Encryption";
    width: 700px;
    height: 600px;

    // Properties for Rust-UI communication
    in-out property <string> input-text: "";
    in-out property <string> output-text: "";
    in-out property <string> key-password: "";
    in-out property <string> status: "Ready";

    property <bool> use-hybrid: true;
    property <bool> use-aes: false;
    property <bool> use-chacha: false;
    property <string> algorithm: "Kyber + AES-GCM (Hybrid)";

    callback encrypt();
    callback decrypt();
    callback clear();
    callback copy-output();
    callback save-output();

    VerticalBox {
        // Header
        HorizontalBox {
            Text {
                text: "üìù Text Encryption";
                font-size: 16px;
                font-weight: 600;
            }
            HorizontalBox { width: 1px; } // Spacer
            Button {
                text: "‚ùå Close";
                clicked => { /* TODO: Close window */ }
            }
        }

        // Separator
        Rectangle { height: 1px; background: #cccccc; }

        // Algorithm Selection
        GroupBox {
            title: "üîê Encryption Algorithm";

            VerticalBox {
                ComboBox {
                    model: ["Kyber + AES-GCM (Hybrid)", "Kyber + ChaCha20-Poly1305", "AES-GCM Only", "ChaCha20-Poly1305 Only"];
                    current-value: algorithm;
                    selected(value) => {
                        algorithm = value;
                        use-hybrid = algorithm == "Kyber + AES-GCM (Hybrid)" || algorithm == "Kyber + ChaCha20-Poly1305";
                        use-aes = algorithm == "Kyber + AES-GCM (Hybrid)" || algorithm == "AES-GCM Only";
                        use-chacha = algorithm == "Kyber + ChaCha20-Poly1305" || algorithm == "ChaCha20-Poly1305 Only";
                    }
                }
                Text {
                    text: "Hybrid encryption combines post-quantum Kyber with symmetric encryption for maximum security.";
                    font-size: 12px;
                    color: #666666;
                }
            }
        }

        // Key/Password Input - REMOVED: Using mnemonic-derived keys
        // GroupBox {
        //     title: "üîë Key / Password";
        //     VerticalBox {
        //         Text { text: "Enter encryption key or password:"; }
        //         LineEdit {
        //             placeholder-text: "Enter key/password...";
        //             text <=> root.key-password;
        //         }
        //         Text {
        //             text: "For hybrid encryption, this will be used to derive the symmetric key.";
        //             font-size: 12px;
        //             color: #666666;
        //         }
        //     }
        // }

        // Input Text
        GroupBox {
            title: "üìù Input Text";

            TextEdit {
                text <=> root.input-text;
                placeholder-text: "Enter text to encrypt/decrypt...";
                wrap: word-wrap;
            }
        }

        // Action Buttons
        HorizontalBox {
            Button {
                text: "üîê Encrypt";
                clicked => { encrypt(); }
            }
            Button {
                text: "üîì Decrypt";
                clicked => { decrypt(); }
            }
            Button {
                text: "üóëÔ∏è Clear";
                clicked => { clear(); }
            }
        }

        // Output Text
        GroupBox {
            title: "üìã Output";

            VerticalBox {
                TextEdit {
                    text: root.output-text;
                    placeholder-text: "Encrypted/decrypted text will appear here...";
                    wrap: word-wrap;
                    read-only: true;
                }
                HorizontalBox {
                    Button {
                        text: "üìã Copy";
                        clicked => { copy-output(); }
                    }
                    Button {
                        text: "üíæ Save to File";
                        clicked => { save-output(); }
                    }
                }
            }
        }

        // Status
        HorizontalBox {
            Text { text: "üìä Status:"; }
            Text {
                text: root.status;
                color: root.status == "Ready" ? #666666 : #00aa00;
            }
        }
    }
}